{"version":3,"file":"index.js","names":["createEnvCore"],"sources":["../src/index.ts"],"sourcesContent":["/**\n * This is the nextjs package of t3-env.\n * It contains the `createEnv` function that you can use to create your schema.\n * @module\n */\nimport type {\n  CreateEnv,\n  CreateSchemaOptions,\n  DefaultCombinedSchema,\n  ServerClientOptions,\n  StandardSchemaDictionary,\n  StandardSchemaV1,\n  StrictOptions,\n} from \"@t3-oss/env-core\";\nimport { createEnv as createEnvCore } from \"@t3-oss/env-core\";\n\nconst CLIENT_PREFIX = \"NEXT_PUBLIC_\";\ntype ClientPrefix = typeof CLIENT_PREFIX;\n\ntype Options<\n  TServer extends StandardSchemaDictionary,\n  TClient extends Record<`${ClientPrefix}${string}`, StandardSchemaV1>,\n  TShared extends StandardSchemaDictionary,\n  TExtends extends Array<Record<string, unknown>>,\n  TFinalSchema extends StandardSchemaV1<{}, {}>,\n> = Omit<\n  StrictOptions<ClientPrefix, TServer, TClient, TShared, TExtends> &\n    ServerClientOptions<ClientPrefix, TServer, TClient> &\n    CreateSchemaOptions<TServer, TClient, TShared, TFinalSchema>,\n  \"runtimeEnvStrict\" | \"runtimeEnv\" | \"clientPrefix\"\n> &\n  (\n    | {\n        /**\n         * Manual destruction of `process.env`. Required for Next.js < 13.4.4.\n         */\n        runtimeEnv: StrictOptions<\n          ClientPrefix,\n          TServer,\n          TClient,\n          TShared,\n          TExtends\n        >[\"runtimeEnvStrict\"];\n        experimental__runtimeEnv?: never;\n      }\n    | {\n        runtimeEnv?: never;\n        /**\n         * Can be used for Next.js ^13.4.4 since they stopped static analysis of server side `process.env`.\n         * Only client side `process.env` is statically analyzed and needs to be manually destructured.\n         */\n        experimental__runtimeEnv: Record<\n          | {\n              [TKey in keyof TClient]: TKey extends `${ClientPrefix}${string}` ? TKey : never;\n            }[keyof TClient]\n          | {\n              [TKey in keyof TShared]: TKey extends string ? TKey : never;\n            }[keyof TShared],\n          string | boolean | number | undefined\n        >;\n      }\n  );\n\n/**\n * Create a new environment variable schema.\n */\nexport function createEnv<\n  TServer extends StandardSchemaDictionary = NonNullable<unknown>,\n  TClient extends Record<`${ClientPrefix}${string}`, StandardSchemaV1> = NonNullable<unknown>,\n  TShared extends StandardSchemaDictionary = NonNullable<unknown>,\n  const TExtends extends Array<Record<string, unknown>> = [],\n  TFinalSchema extends StandardSchemaV1<{}, {}> = DefaultCombinedSchema<TServer, TClient, TShared>,\n>(\n  opts: Options<TServer, TClient, TShared, TExtends, TFinalSchema>,\n): CreateEnv<TFinalSchema, TExtends> {\n  const client = typeof opts.client === \"object\" ? opts.client : {};\n  const server = typeof opts.server === \"object\" ? opts.server : {};\n  const shared = opts.shared;\n\n  const runtimeEnv = opts.runtimeEnv\n    ? opts.runtimeEnv\n    : {\n        ...process.env,\n        ...opts.experimental__runtimeEnv,\n      };\n\n  return createEnvCore<ClientPrefix, TServer, TClient, TShared, TExtends, TFinalSchema>({\n    ...opts,\n    shared,\n    client,\n    server,\n    clientPrefix: CLIENT_PREFIX,\n    runtimeEnv,\n  });\n}\n"],"mappings":";;;AAgBA,MAAM,gBAAgB;;;;AAkDtB,SAAgB,UAOd,MACmC;CACnC,MAAM,SAAS,OAAO,KAAK,WAAW,WAAW,KAAK,SAAS,EAAE;CACjE,MAAM,SAAS,OAAO,KAAK,WAAW,WAAW,KAAK,SAAS,EAAE;CACjE,MAAM,SAAS,KAAK;CAEpB,MAAM,aAAa,KAAK,aACpB,KAAK,aACL;EACE,GAAG,QAAQ;EACX,GAAG,KAAK;EACT;AAEL,QAAOA,YAA+E;EACpF,GAAG;EACH;EACA;EACA;EACA,cAAc;EACd;EACD,CAAC"}